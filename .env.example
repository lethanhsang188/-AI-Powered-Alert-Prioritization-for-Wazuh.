# AI-Powered Alert Prioritization for Wazuh - Environment Configuration
# Copy this file to .env and fill in your actual values

# =============================================================================
# WAZUH CONNECTION SETTINGS
# =============================================================================

# Wazuh Manager API (for manager operations - optional)
WAZUH_API_URL=https://wazuh-manager:55000
WAZUH_API_USER=wazuh
WAZUH_API_PASS=your_wazuh_api_password
WAZUH_API_TOKEN=
WAZUH_API_VERIFY_SSL=true

# Wazuh Indexer (Elasticsearch) - REQUIRED for alert collection
WAZUH_INDEXER_URL=https://wazuh-indexer:9200
WAZUH_INDEXER_USER=admin
WAZUH_INDEXER_PASS=your_indexer_password
WAZUH_INDEXER_VERIFY_SSL=true

# Alert collection settings
WAZUH_ALERTS_INDEX=wazuh-alerts-*
WAZUH_MIN_LEVEL=3
WAZUH_MAX_LEVEL=15
WAZUH_PAGE_LIMIT=100
WAZUH_MAX_BATCHES=10
WAZUH_LOOKBACK_MINUTES=60
WAZUH_POLL_INTERVAL_SEC=30
WAZUH_DEMO_MODE=false
WAZUH_START_FROM_NOW=false
WAZUH_REALTIME_MODE=false

# Include specific rule IDs (comma-separated, empty = all)
INCLUDE_RULE_IDS=
INCLUDE_RULE_ID_PREFIX=100,200,300,400,500,600,700,800,900
ALWAYS_REEVALUATE_LEVEL_GTE=10

# =============================================================================
# AI/LLM ANALYSIS SETTINGS (Optional)
# =============================================================================

# Enable LLM analysis for enhanced threat assessment
LLM_ENABLE=true
OPENAI_API_KEY=sk-proj-your_openai_api_key_here
LLM_MODEL=gpt-4o-mini
LLM_MAX_TOKENS=1000
LLM_TEMPERATURE=0.1
LLM_TIMEOUT_SEC=30
LLM_CACHE_ENABLED=true
LLM_MAX_RETRIES=3

# LLM scoring weights (must sum to 1.0)
HEURISTIC_WEIGHT=0.6
LLM_WEIGHT=0.4

# =============================================================================
# TRIAGE AND SCORING SETTINGS
# =============================================================================

# Triage threshold (0.0-1.0) - alerts above this trigger active response
TRIAGE_THRESHOLD=0.70

# Threat level mapping
TRIAGE_CRITICAL_THRESHOLD=0.85
TRIAGE_HIGH_THRESHOLD=0.70
TRIAGE_MEDIUM_THRESHOLD=0.50

# Priority agent IDs for active response (comma-separated)
PRIORITY_AGENT_IDS=001,002

# =============================================================================
# AUTOMATED RESPONSE SETTINGS
# =============================================================================

# Enable automatic threat blocking
ENABLE_ACTIVE_RESPONSE=true
ACTIVE_RESPONSE_REQUIRE_CONFIRM=false

# Active response policy settings
ACTIVE_RESPONSE_ALLOWLIST=192.168.1.0/24,10.0.0.0/8,127.0.0.1
ACTIVE_RESPONSE_SUPPRESSION_WINDOW_SECONDS=600
ACTIVE_RESPONSE_MAX_NOTIFICATIONS=3

# Fast block triggers
FAST_BLOCK_TAGS=sql_injection,xss,csrf,command_injection,lfi,rfi,web_attack,brute_force,dos,syn
FAST_BLOCK_SURICATA_SEVERITY=1

# pfSense SSH connection for blocking
PFSENSE_HOST=192.168.1.1
PFSENSE_USER=admin
PFSENSE_SSH_KEY_PATH=C:\Users\YourUser\.ssh\id_ed25519
PFSENSE_BLOCK_TABLE=WAZUH_BLOCK
PFSENSE_AUTO_UNBLOCK_MINUTES=1440

# =============================================================================
# NOTIFICATION SETTINGS
# =============================================================================

# Telegram notifications
TELEGRAM_BOT_TOKEN=your_telegram_bot_token
TELEGRAM_CHAT_ID=your_chat_id
TELEGRAM_MESSAGE_FORMAT=MARKDOWN
TELEGRAM_MAX_MESSAGE_LENGTH=4000

# Webhook notifications (optional)
WEBHOOK_URL=
WEBHOOK_VERIFY_SSL=true

# =============================================================================
# CORRELATION AND ENRICHMENT SETTINGS
# =============================================================================

# Alert correlation settings
CORRELATION_TIME_WINDOW_MINUTES=15
CORRELATION_ENABLED=true

# Supply chain attack detection
SUPPLY_CHAIN_ATTACK_DETECTION=true
SUPPLY_CHAIN_SEVERITY_HIGH_THRESHOLD=3
SUPPLY_CHAIN_SEVERITY_MEDIUM_THRESHOLD=2

# Threat intelligence enrichment
VIRUSTOTAL_API_KEY=
VIRUSTOTAL_ENABLED=false

# =============================================================================
# LOGGING AND MONITORING SETTINGS
# =============================================================================

# Logging configuration
LOG_LEVEL=INFO
LOG_FORMAT=structured
LOG_FILE_PATH=logs/pipeline.log
LOG_MAX_SIZE_MB=100
LOG_BACKUP_COUNT=5

# Performance monitoring
PERFORMANCE_MONITORING_ENABLED=true
METRICS_EXPORT_INTERVAL_SEC=60

# =============================================================================
# API SERVICE SETTINGS (Optional)
# =============================================================================

# REST API for monitoring and integration
API_ENABLED=true
API_HOST=0.0.0.0
API_PORT=5000
API_DEBUG=false
API_SECRET_KEY=your_api_secret_key

# =============================================================================
# SECURITY AND COMPLIANCE SETTINGS
# =============================================================================

# PII redaction before LLM processing
PII_REDACTION_ENABLED=true
PII_PATTERNS=email,phone,credit_card,ssn

# SSL/TLS settings
SSL_VERIFY_CERTIFICATES=true
SSL_CERT_PATH=

# Security headers and hardening
SECURITY_HEADERS_ENABLED=true

# =============================================================================
# DEVELOPMENT AND TESTING SETTINGS
# =============================================================================

# Development mode settings
DEBUG_MODE=false
DRY_RUN_MODE=false

# Testing settings
TEST_MODE=false
MOCK_EXTERNAL_APIS=false

# =============================================================================
# SYSTEM AND PERFORMANCE SETTINGS
# =============================================================================

# Resource limits
MAX_MEMORY_MB=512
MAX_CPU_CORES=2

# Timeouts
REQUEST_TIMEOUT_SEC=30
CONNECTION_TIMEOUT_SEC=10

# Caching
CACHE_ENABLED=true
CACHE_TTL_MINUTES=60
CACHE_MAX_SIZE_MB=50

# =============================================================================
# LOCALIZATION AND TIMEZONE SETTINGS
# =============================================================================

# Timezone settings
LOCAL_TIMEZONE=Asia/Ho_Chi_Minh
DISPLAY_TIMEZONE=Asia/Ho_Chi_Minh

# Language and localization
LANGUAGE=en
DATE_FORMAT=YYYY-MM-DD HH:mm:ss

# =============================================================================
# STATE MANAGEMENT SETTINGS
# =============================================================================

# Cursor and state file paths
CURSOR_PATH=state/cursor.json
BLOCKED_IPS_PATH=state/blocked_ips.json

# State backup settings
STATE_BACKUP_ENABLED=true
STATE_BACKUP_INTERVAL_MINUTES=60

# =============================================================================
# INTEGRATION SETTINGS
# =============================================================================

# TheHive integration (optional)
THEHIVE_ENABLED=false
THEHIVE_URL=https://thehive:9000
THEHIVE_API_KEY=your_thehive_api_key

# MISP integration (optional)
MISP_ENABLED=false
MISP_URL=https://misp:443
MISP_API_KEY=your_misp_api_key

# Custom integrations
CUSTOM_INTEGRATION_ENABLED=false
CUSTOM_INTEGRATION_WEBHOOK_URL=