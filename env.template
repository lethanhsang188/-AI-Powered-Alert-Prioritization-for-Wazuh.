# Wazuh Configuration
WAZUH_API_URL=https://192.168.10.128:55000
WAZUH_API_USER=wazuh-wui
WAZUH_API_PASS=wazuh-wui
WAZUH_API_TOKEN=
WAZUH_MIN_LEVEL=7
WAZUH_POLL_INTERVAL_SEC=8
WAZUH_REALTIME_MODE=false
WAZUH_REALTIME_INTERVAL_SEC=1.0
WAZUH_PAGE_LIMIT=200
WAZUH_MAX_BATCHES=5
WAZUH_LOOKBACK_MINUTES=0  # Real-time mode: 0 = auto-calculate from poll_interval + indexer_delay + buffer, or set manual minutes
WAZUH_DEMO_MODE=false  # Enable demo mode: ignore cursor, use LOOKBACK_MINUTES
WAZUH_START_FROM_NOW=true  # Real-time mode: ignore cursor, use dynamic lookback to avoid missing alerts (RECOMMENDED for SOC)
# Real-time processing recommendations:
# - RECOMMENDED: Set WAZUH_START_FROM_NOW=true for real-time processing without missing alerts
#   * When WAZUH_START_FROM_NOW=true, it auto-calculates lookback from poll_interval (8s) + max_indexer_delay (30s) + buffer (10s) â‰ˆ 1 minute
#   * Or set WAZUH_LOOKBACK_MINUTES manually (e.g., 1-2 minutes)
#   * This ensures you fetch new alerts without missing any, but don't fetch very old alerts
# - For real-time demo/testing: Set WAZUH_DEMO_MODE=true and WAZUH_LOOKBACK_MINUTES=5
# - For production: Use WAZUH_REALTIME_MODE=true with WAZUH_REALTIME_INTERVAL_SEC=1.0
# - Note: Wazuh Indexer has 5-30s delay, so alerts may not appear immediately
CURSOR_PATH=/app/state/cursor.json
# WAZUH_API_VERIFY_SSL can be:
# - "true" or "false" (boolean) - verify with system CA or disable
# - Path to cert file (string) - e.g., "cert wazuh/wazuh-api-server.crt"
# - If set to "true" and cert file exists at "cert wazuh/wazuh-api-server.crt", it will be auto-detected
WAZUH_API_VERIFY_SSL=true
WAZUH_INDEXER_URL=https://192.168.10.128:9200
WAZUH_INDEXER_USER=admin
WAZUH_INDEXER_PASS=admin
# WAZUH_INDEXER_VERIFY_SSL can be:
# - "true" or "false" (boolean) - verify with system CA or disable
# - Path to cert file (string) - e.g., "cert wazuh/wazuh-indexer.crt"
# - If set to "true" and cert file exists at "cert wazuh/wazuh-indexer.crt", it will be auto-detected
WAZUH_INDEXER_VERIFY_SSL=true
WAZUH_ALERTS_INDEX=wazuh-alerts-*

# LLM Configuration (optional)
LLM_ENABLE=true
# Replace with your OpenAI API key (get from https://platform.openai.com/api-keys)
OPENAI_API_KEY=your-openai-api-key-here
# OpenAI API Base URL
# Official OpenAI API: https://api.openai.com/v1
# For proxy services (if needed): https://agentrouter.org/v1 or https://agentrouter.org/api/v1
OPENAI_API_BASE=https://api.openai.com/v1
# Available models: gpt-5.2 (latest), gpt-5.1, gpt-5-mini, gpt-5-nano, gpt-4o-mini
LLM_MODEL=gpt-5.2
LLM_MAX_TOKENS=1024
LLM_TIMEOUT_SEC=20

# Triage Weights (must sum to 1.0)
HEURISTIC_WEIGHT=0.6
LLM_WEIGHT=0.4
TRIAGE_THRESHOLD=0.70

# Telegram Bot Configuration
# Get bot token from @BotFather on Telegram: https://t.me/botfather
TELEGRAM_BOT_TOKEN=your-telegram-bot-token-here
# Get chat ID by messaging your bot and checking: https://api.telegram.org/bot<TOKEN>/getUpdates
TELEGRAM_CHAT_ID=your-telegram-chat-id-here

# API Configuration
API_PORT=8088

# General Configuration
ENV_NAME=dev
LOG_LEVEL=INFO
LOCAL_TIMEZONE=Asia/Ho_Chi_Minh

# SOC-Grade Filtering Configuration (Three-Tier Approach)
# Tier 1: Include alerts with level [MIN_LEVEL..MAX_LEVEL] AND rule.id in INCLUDE_RULE_IDS or starts with INCLUDE_RULE_ID_PREFIX
# Tier 2: Always include alerts with level >= ALWAYS_REEVALUATE_LEVEL_GTE for AI re-evaluation
# Tier 3: Include alerts with attack indicators in fields (data.alert.category, data.alert.signature, data.event_type)
#         This ensures we don't miss real attacks even if they don't match rule IDs
MIN_LEVEL=3
MAX_LEVEL=7
# Comma-separated list of rule IDs to include (e.g., "100100,86601" for custom rules + Suricata rules)
INCLUDE_RULE_IDS=100100  # Example: "100100,86601" to include both Wazuh custom rules and Suricata XSS rules
# Optional prefix for rule IDs (e.g., "1001" matches 100100, 100101, etc.)
# NOTE: Currently supports single prefix only. For multiple prefixes, add specific rule IDs to INCLUDE_RULE_IDS instead.
INCLUDE_RULE_ID_PREFIX=1001  # Example: "1001" matches 100100, 100101, etc. For Suricata rules (86601), add to INCLUDE_RULE_IDS
ALWAYS_REEVALUATE_LEVEL_GTE=7  # Always include and re-evaluate alerts with level >= this value
# Tier 3 automatically detects attacks from fields (category, signature, event_type) - no config needed
LOOKBACK_MINUTES_CORRELATION=30  # Lookback window for correlation (minutes)
DEDUP_WINDOW_MINUTES=10  # Deduplication window to avoid Telegram spam (minutes)

# Correlation Configuration (group related alerts)
CORRELATION_ENABLE=true
CORRELATION_TIME_WINDOW_MINUTES=15

# Enrichment Configuration (GeoIP, threat intelligence)
ENRICHMENT_ENABLE=true
GEOIP_ENABLE=true

# LLM Cache Configuration (improve performance)
LLM_CACHE_ENABLE=true
LLM_CACHE_TTL_SECONDS=3600
LLM_CACHE_MAX_SIZE=1000

